import numpy as np
import math

def f(a):
    '''Ñ†ÐµÐ»ÐµÐ²Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ'''
    # ð‘“(ð‘¥1, ð‘¥2) = 2(ð‘¥1)^2 + 5(ð‘¥2)^2 + (ð‘¥1)(ð‘¥2) âˆ’ 3(ð‘¥1) âˆ’ (ð‘¥2)
    return math.prod([2, (pow(a[0], 2))]) + math.prod([5, (pow(a[1], 2))]) + math.prod([a[0], a[1]]) - math.prod([3, a[0]]) - a[1]

def grad(a):
    '''Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð²ÐµÐºÑ‚Ð¾Ñ€ Ð³Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ð° Ð² Ð¼Ð°ÑÑÐ¸Ð²'''
    return np.array([4*a[0] + a[1] - 3 , 10*a[1] + a[0] - 1])

def opt_a(A):
    '''Ñ€ÐµÑˆÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ a (Ð¼ÐµÑ‚Ð¾Ð´ Ð´Ð¸Ñ…Ð¾Ñ‚Ð¾Ð¼Ð¸Ð¸)'''
    b1, b2 = -100, 100  # Ð³Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð¾Ñ‚Ñ€ÐµÐ·ÐºÐ° Ð»Ð¾ÐºÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼Ð°
    e = 0.0001          # Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð²Ñ‹Ñ‡ÐµÑÐ»ÐµÐ½Ð¸Ð¹
    d = e / 2

    x1 = (b1 + b2 - d) / 2
    x2 = (b1 + b2 + d) / 2

    while (b2 - b1)/2 > e:
        if A(x1) > A(x2): b1 = x1
        else: b2 = x2
        x1 = (b1 + b2 - d) / 2
        x2 = (b1 + b2 + d) / 2
    a = (b2+b1)/2

    return a

def fastest_ClimbDown(e):
    '''Ð¼ÐµÑ‚Ð¾Ð´ Ð½Ð°Ð¸ÑÐºÐ¾Ñ€ÐµÐ¹ÑˆÐµÐ³Ð¾ ÑÐ¿ÑƒÑÐºÐ°'''
    x = {}
    x[0] = [1, 1]   # Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ñ‚Ð¾Ñ‡ÐºÐ°

    j = 0
    while (grad(x[0])[0]**2 + grad(x[0])[1]**2)**(1/2) > e:
        
        for i in range(len(x[0])):
            x[0][i] = x[0][i] - opt_a(lambda a: f(x[0] - a*grad(x[0])))*grad(x[0])[i]
            
        j += 1
        
        print(f'[{j}, [%0.3f; %0.3f], %0.3f, %0.3f]' % (x[0][0], x[0][1], f(x[0]), opt_a(lambda a: f(x[0] - a*grad(x[0]))) ))
        
    print('')
    print('Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ñ… = [%0.3f; %0.3f]' % (x[0][0], x[0][0]))
    print('Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ f(Ñ…) = %0.3f' % (f(x[0])))




fastest_ClimbDown(0.0001)
